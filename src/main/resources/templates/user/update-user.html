<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>사용자 정보 수정</title>
    <link rel="stylesheet" href="/css/footer.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css">
</head>
<body th:replace="~{layout::layout}">
<div th:fragment="content" class="container my-5" style="max-width: 800px;">
    <div class="card shadow">
        <div class="card-body m-4">
            <h2 class="card-title text-center mb-4 fw-bold">👥 사용자 정보 수정</h2>
            <form action="#" method="post" th:action="@{/admin/users/update/{userId}(userId=${user.userId})}" enctype="multipart/form-data">
                <div class="mb-3">
                    <label for="id" class="form-label fw-bold">이메일(아이디) <span class="text-danger">(필수)</span></label>
                    <input type="text" id="id" name="email" class="form-control" th:value="${user.email}" required>
                </div>
                <div class="mb-3">
                    <label for="nickname" class="form-label fw-bold">닉네임(2자 이상 10자 이하) <span class="text-danger">(필수)</span></label>
                    <input type="text" id="nickname" name="nickname" class="form-control" th:value="${user.nickname}" required>
                </div>
                <div class="mb-3">
                    <label for="oauthProvider" class="form-label fw-bold">OAuth Provider</label>
                    <input type="text" id="oauthProvider" name="oauthProvider" class="form-control" th:value="${user.oauthProvider}">
                </div>
                <div class="mb-3">
                    <label for="oauthId" class="form-label fw-bold">OAuth Id</label>
                    <input type="text" id="oauthId" name="oauthId" class="form-control" th:value="${user.oauthId}">
                </div>
                <div class="mb-3">
                    <label for="role" class="form-label fw-bold">권한 설정(기존: [[${user.role}]]) <span class="text-danger">(필수)</span></label>
                    <select id="role" name="role" class="form-select" required>
                        <option value="USER">USER(사용자)</option>
                        <option value="ADMIN">ADMIN(관리자)</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label for="fcmToken" class="form-label fw-bold">FCM Token</label>
                    <input type="text" id="fcmToken" name="fcmToken" class="form-control" th:value="${user.fcmToken}">
                </div>
                <div class="mb-3">
                    <label for="subscriptionStatus" class="form-label fw-bold">구독 상태 <span class="text-danger">(필수)</span></label>
                    <input type="text" id="subscriptionStatus" name="subscriptionStatus" class="form-control" th:value="${user.subscriptionStatus}" required>
                </div>
                <div class="mb-3">
                    <label class="form-label fw-bold">기존 프로필 사진</label><br>
                    <img th:src="${user.profileImageUrl}" width="180" height="180" class="img-thumbnail" alt="프로필 사진">
                </div>
                <div class="mb-3">
                    <label for="file" class="form-label fw-bold">프로필 사진 변경 (선택)</label>
                    <input type="file" id="file" name="imageFile" class="form-control">
                </div>
                <div th:if="${param.error}" class="alert alert-danger">
                    사용자 정보 수정에 실패했습니다. 다시 한 번 시도해 주세요.
                </div>
                <div class="d-flex justify-content-center gap-3 mt-4">
                    <a th:href="@{/admin/users/{userId}(userId=${param.userId})}" class="btn btn-secondary">취소</a>
                    <button type="submit" class="btn btn-primary">수정</button>
                </div>
            </form>
        </div>
    </div>
</div>
</body>
</html>